example_long_md$yyijk_IC,
example_long_md$ttij_IC,
example_long_md$nobs_IC,
pattern,side="upward",
method="decorrelation EWMA",
parameter=0.5,control_limit=Inf)
chart_OC_output<-mnt_long_md(
example_long_md$yyijk_OC,
example_long_md$ttij_OC,
example_long_md$nobs_OC,
pattern,side="upward",
method="decorrelation EWMA",
parameter=0.5,control_limit=Inf)
example_long_md$ttij_IC
chart_IC_output$chart
eva_output_two<-eva_control_chart_two(
chart_IC_output$chart,example_long_md$ttij_IC,example_long_md$nobs_IC,
rep(1,nind_IC),rep(ntimepoints,nind_IC),
chart_OC_output$chart,example_long_md$ttij_OC,example_long_md$nobs_OC,
rep(1,nind_OC),rep(ntimepoints,nind_OC),
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
nind_OC
nind_IC<-dim(example_long_md$yyijk_IC)[1]
nind_OC<-dim(example_long_md$yyijk_OC)[1]
ntimepoints<-example_long_md$ntimepoints
ndim<-dim(example_long_md$yyijk_IC)[3]
eva_output_two<-eva_control_chart_two(
chart_IC_output$chart,example_long_md$ttij_IC,example_long_md$nobs_IC,
rep(1,nind_IC),rep(ntimepoints,nind_IC),
chart_OC_output$chart,example_long_md$ttij_OC,example_long_md$nobs_OC,
rep(1,nind_OC),rep(ntimepoints,nind_OC),
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
plot(eva_output_one)
plot(eva_output_two)
plot_PMROC(eva_output_two)
data("example_long_surv")
dim(example_long_surv$yyijk)[1]
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_risk<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="risk",smoothing="local linear",
hh_beta=10,hh_mean=25,hh_var=25)
data("example_long_surv")
names(example_long_surv)
chart_risk<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_risk,method="risk",
parameter=0.2,control_limit=Inf)
args(eva_control_chart_one)
args(eva_control_chart_one)
args(mnt_long_surv)
args(eva_control_chart_one)
eva_control_chart_one(
chart_risk$chart,
example_long_surv$ttij,
example_long_surv$nobs,
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
args(eva_control_chart_one)
eva_output_one<-eva_control_chart_one(
chart_risk$chart,
example_long_surv$ttij,
example_long_surv$nobs,
starttime=rep(1,nind),
endtime=rep(ntimepoints,nind),
event=example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
plot(eva_output_one)
plot(eva_output_one)
plot_PMROC(eva_output_two)
plot(eva_output_risk)
args(eva_control_chart_one)
eva_output_risk<-eva_control_chart_one(
chart_risk$chart,
example_long_surv$ttij,
example_long_surv$nobs,
starttime=rep(1,nind),
endtime=rep(ntimepoints,nind),
event=example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
plot(eva_output_risk)
plot_PMROC(eva_output_risk)
# usethis::use_vignette("DySS")
devtools::build_vignettes()
head(example_long_md$yyij_IC[,1:5,])
example_long_md
head(example_long_md$yyijk_IC[,1:5,])
example_long_md$yyijk_IC[,1:5,]
example_long_md$yyijk_IC[,1:5,]
dim(example_long_md$yyijk_IC[,1:5,])
example_long_md$yyijk_IC[,1:5,]
head(example_long_md$yyijk_IC[,1:5,])
example_long_md$yyijk_IC[1:6,1:5,]
example_long_md$yyijk_IC[1:6,1:5,]
head(example_long_md$ttij_IC[,1:5])
head(example_long_md$nobs_IC)
nind_IC<-dim(example_long_md$yyijk_IC)[1]
nind_OC<-dim(example_long_md$yyijk_OC)[1]
ntimepoints<-example_long_md$ntimepoints
ndim<-dim(example_long_md$yyijk_IC)[3]
pattern<-est_pattern_long_md(
example_long_md$yyijk_IC,
example_long_md$ttij_IC,
example_long_md$nobs_IC,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="meanvarcov",hh_mean=8,hh_var=8,hh_cov=8)
chart_IC_output<-mnt_long_md(
example_long_md$yyijk_IC,
example_long_md$ttij_IC,
example_long_md$nobs_IC,
pattern,side="upward",
method="decorrelation EWMA",
parameter=0.5,control_limit=Inf)
chart_OC_output<-mnt_long_md(
example_long_md$yyijk_OC,
example_long_md$ttij_OC,
example_long_md$nobs_OC,
pattern,side="upward",
method="decorrelation EWMA",
parameter=0.5,control_limit=Inf)
# usethis::use_vignette("DySS")
devtools::build_vignettes()
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_joint<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="joint",smoothing="local quadratic",
hh=50)
args(est_pattern_long_surv)
devtools::build_vignettes()
data("example_long_surv")
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_risk<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="risk",smoothing="local linear",
hh_beta=10,hh_mean=25,hh_var=25)
library(DySS)
data("example_long_surv")
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_risk<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="risk",smoothing="local linear",
hh_beta=10,hh_mean=25,hh_var=25)
chart_risk<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_risk,method="risk",
parameter=0.2,control_limit=Inf)
eva_output_risk<-eva_control_chart_one(
chart_risk$chart,
example_long_surv$ttij,
example_long_surv$nobs,
starttime=rep(1,nind),
endtime=rep(ntimepoints,nind),
event=example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
plot(eva_output_risk)
plot_PMROC(eva_output_risk)
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_joint<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="joint",smoothing="local quadratic",
hh=50)
joint_local_linear
library(DySS)
library(DySS)
data("example_long_surv")
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
args(est_pattern_long_surv)
pattern_risk<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="risk",smoothing="local linear",
hh_beta=10,hh_mean=25,hh_var=25)
args(mnt_long_surv)
chart_risk<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_risk,method="risk",
parameter=0.2,control_limit=Inf)
args(eva_control_chart_one)
eva_output_risk<-eva_control_chart_one(
chart_risk$chart,
example_long_surv$ttij,
example_long_surv$nobs,
starttime=rep(1,nind),
endtime=rep(ntimepoints,nind),
event=example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
plot(eva_output_risk)
plot_PMROC(eva_output_risk)
matplot(t(chart_risk$chart),type="l")
chart_risk$chart
args(est_pattern_long_surv)
pattern_joint<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="joint",smoothing="local linear",
hh=50)
chart_joint<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_joint,method="joint",
parameter=0.2,control_limit=Inf)
args(mnt_long_surv)
args(chart_joint)
chart_joint<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_joint,method="joint",
parameter=0.2,control_limit=Inf)
args(chart_joint)
library(DySS)
args(mnt_long_surv)
chart_joint<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_joint,method="joint",
parameter=0.2,control_limit=Inf)
matplot(t(chart_joint$chart),type="l")
data("example_long_surv")
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_risk<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="risk",smoothing="local linear",
hh_beta=10,hh_mean=25,hh_var=25)
chart_risk<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_risk,method="risk",
parameter=0.2,control_limit=Inf)
eva_output_risk<-eva_control_chart_one(
chart_risk$chart,
example_long_surv$ttij,
example_long_surv$nobs,
starttime=rep(1,nind),
endtime=rep(ntimepoints,nind),
event=example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
plot(eva_output_risk)
plot_PMROC(eva_output_risk)
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_joint<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="joint",smoothing="local quadratic",
hh=50)
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_joint<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="joint",smoothing="local quadratic",
hh=50)
chart_joint<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
ntimepoints,
pattern=pattern_risk,method="joint",
parameter=0.2,control_limit=Inf)
eva_output_joint<-eva_control_chart_one(
chart_joint$chart,
example_long_surv$ttij,
example_long_surv$nobs,
starttime=rep(1,nind),
endtime=rep(ntimepoints,nind),
event=example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
plot(eva_output_joint)
plot_PMROC(eva_output_joint)
args(mnt_long_surv)
chart_joint<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_risk,method="joint",
parameter=0.2,control_limit=Inf)
args(mnt_long_surv)
pattern_joint
args(mnt_long_surv)
chart_joint<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_risk,method="joint",
parameter=0.2,control_limit=Inf)
chart_joint<-mnt_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
pattern=pattern_joint,method="joint",
parameter=0.2,control_limit=Inf)
eva_output_joint<-eva_control_chart_one(
chart_joint$chart,
example_long_surv$ttij,
example_long_surv$nobs,
starttime=rep(1,nind),
endtime=rep(ntimepoints,nind),
event=example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints)
plot(eva_output_joint)
plot_PMROC(eva_output_joint)
devtools::build_vignettes()
cl
library(survival)
survdiff(Surv(time,event)~group, data=g3)
library(survival)
survdiff(Surv(time,event)~group, data=g3)
survdiff(Surv(time,Status)~sex,data=myeloma)
survdiff(Surv(futime,fustat)~rx,data=ovarian)
coxph(Surv(futime,fustat)~rx,data=ovarian)
survdiff(Surv(futime,fustat)~rx,data=ovarian)
coxph(Surv(futime,fustat)~rx,data=ovarian)
names(survdiff(Surv(futime,fustat)~rx,data=ovarian))
survdiff(Surv(futime,fustat)~rx,data=ovarian)$chisq
coxph(Surv(futime,fustat)~rx,data=ovarian)
coxph(Surv(futime,fustat)~rx,data=ovarian,ties="exact")
survdiff(Surv(futime,fustat)~rx,data=ovarian)$chisq
coxph(Surv(futime,fustat)~rx,data=ovarian,ties="exact")
ovarian$rx
coxph(Surv(futime,fustat)~rx,data=ovarian,ties="exact")
coxph(Surv(futime,fustat)~as.factor(rx),data=ovarian,ties="exact")
survdiff(Surv(futime,fustat)~rx,data=ovarian)$chisq
coxph(Surv(futime,fustat)~as.factor(rx),data=ovarian,ties="exact")
summary(coxph(Surv(futime,fustat)~as.factor(rx),data=ovarian,ties="exact"))
names(summary(coxph(Surv(futime,fustat)~as.factor(rx),data=ovarian,ties="exact")))
summary(coxph(Surv(futime,fustat)~as.factor(rx),data=ovarian,ties="exact"))$sctest
survdiff(Surv(futime,fustat)~rx,data=ovarian)$chisq
objective_function<-function(P0){
P0^0.43+P0-2*40/75
}
uniroot(objective_function,0,2)
uniroot(objective_function,c(0,2))
uniroot(objective_function,c(0,2))$root
P0<-uniroot(objective_function,c(0,2))$root
P0
P0^0.43
P1<-P0^0.43
log(P1)/log(P0)
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2
HR<-0.43
P0<-uniroot(objective_function,c(0,2))$root
P1<-P0^HR
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2/(2-P1-P0)
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2/(2-P1-P0)
P1
P0
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2/(2-P1-P0)
library(powerSurvEpi)
library(powerSurvEpi)
ssizeCT.default(power=0.8,
k=1,
pE=1-P1,
pC=1-P0,
RR=HR,
alpha=0.05)
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2/(2-P1-P0)
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2/(2-P1-P0)/0.9
log(P1)
log(P0)
log(P1)
log(P0)
log(P0)
-log(P1)
-log(P0)
(-log(P1))/(-log(P0))
(qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5*HR^2)
(qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5)*HR^2
HR^2
(qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5)
(qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5*HR^2)
(qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5*HR^2)
HR
(qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5*log(HR)^2)
ceiling((qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5*log(HR)^2))
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2/(2-P1-P0)/0.9
((HR+1)/(HR-1))^2*(qnorm(0.975)+qnorm(0.8))^2/(2-P1-P0)
## Second method
ceiling((qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5*log(HR)^2))
## Second method
nevents<-ceiling((qnorm(0.975)+qnorm(0.8))^2/(0.5*0.5*log(HR)^2))
nevents
AA<-matrix(0,5,5)
row(AA)-col(AA)
AA<-matrix(0,5,5)
AA<-abs(row(AA)-col(AA))
AA
diag(5)-matrix(1,5,5)/5
AA<-matrix(0,5,5)
AA<-abs(row(AA)-col(AA))
JJ<-diag(5)-matrix(1,5,5)/5
JJ%*%DD%*%JJ
DD<-matrix(0,5,5)
DD<-abs(row(DD)-col(DD))
JJ<-diag(5)-matrix(1,5,5)/5
JJ%*%DD%*%JJ
-JJ%*%DD%*%JJ
eigen(-JJ%*%DD%*%JJ)
library(DySS)
control_limit<-search_control_limit(
chart_IC_output$chart,
example_long_1d$ttij_IC,
example_long_1d$nobs_IC,
starttime=rep(0,nind_IC),
endtime=rep(ntimepoints,nind_IC),
ttmin=1,ttmax=ntimepoints,
ntimepoints=ntimepoints,
limit_lower=0,limit_upper=10,limit_step=0.1,ATS_nominal=50)
search_control_limit
args(search_control_limit)
library(DySS)
args(DySS)
args(search_control_limit)
args(eva_calculate_ATS)
add_search_control_limit_omit
library(DySS)
ntimepoints<-example_long_surv$ntimepoints
data("example_long_surv")
ntimepoints<-example_long_surv$ntimepoints
nind<-dim(example_long_surv$yyijk)[1]
pattern_joint<-est_pattern_long_surv(
example_long_surv$yyijk,
example_long_surv$ttij,
example_long_surv$nobs,
example_long_surv$starttime,
example_long_surv$survtime,
example_long_surv$survevent,
ttmin=1,ttmax=ntimepoints,ntimepoints=ntimepoints,
method="joint",smoothing="local quadratic",
hh=50)
